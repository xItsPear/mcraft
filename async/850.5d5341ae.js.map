{"version":3,"file":"static/js/async/850.5d5341ae.js","sources":["webpack://minecraft-web-client/./src/react/prosemirror-markdown.ts"],"sourcesContent":["import { EditorView } from 'prosemirror-view'\r\nimport { EditorState } from 'prosemirror-state'\r\nimport { schema, defaultMarkdownParser, defaultMarkdownSerializer } from 'prosemirror-markdown'\r\nimport { exampleSetup, buildMenuItems } from 'prosemirror-example-setup'\r\nimport { MarkSpec } from 'prosemirror-model'\r\nimport { toggleMark } from 'prosemirror-commands'\r\n\r\nexport class ProseMirrorView {\r\n  view\r\n\r\n  constructor (target, content) {\r\n    console.log('schema.marks', schema.marks)\r\n    //@ts-expect-error\r\n    schema.marks.textColor = {\r\n      spec: {\r\n        attrs: { color: {} },\r\n        inline: true,\r\n        parseDOM: [\r\n          {\r\n            style: 'color',\r\n            getAttrs: value => ({ color: value })\r\n          }\r\n        ],\r\n        toDOM: mark => ['span', { style: `color: ${mark.attrs.color}` }, 0]\r\n      },\r\n    }\r\n\r\n    const fullMenu = buildMenuItems(schema).fullMenu as Array<Array<import('prosemirror-menu').MenuItem>>\r\n    fullMenu[0] = fullMenu[0].filter(item => item.spec.title !== 'Add or remove link' && item.spec.title !== 'Toggle code font')\r\n    fullMenu.splice(3, 1); // remove the insert list, quote & checkbox menu\r\n    (fullMenu[1][0] as any).options.label = 'Color' // check-build error: fullMenu[1][0].options.label = 'Color'\r\n    // fullMenu[1][0].content[0].spec.label = 'Red'\r\n    // fullMenu[1][0].content[0].spec.run = (state, dispatch, view) => {\r\n    // console.log('state', state)\r\n    // // make <p style=\"color: red\">...</p>\r\n    // const { from, to } = state.selection\r\n    // const { tr } = state\r\n    // console.log(schema.marks)\r\n    // tr.addMark(from, to, schema.marks.textColor.create({ color: 'red' }))\r\n    // dispatch(tr)\r\n    //   toggleMark(schema.marks.textColor, { color: 'red' })(state, dispatch, view)\r\n    // }\r\n    fullMenu[1].splice(1, 1) // remove the type menu\r\n    console.log('fullMenu', fullMenu)\r\n    this.view = new EditorView(target, {\r\n      state: EditorState.create({\r\n        doc: defaultMarkdownParser.parse(content) ?? undefined,\r\n        plugins: exampleSetup({\r\n          schema,\r\n          menuContent: fullMenu,\r\n        }),\r\n      }),\r\n      attributes (state) {\r\n        return {\r\n          autocorrect: 'off',\r\n          autocapitalize: 'off',\r\n          spellcheck: 'false',\r\n          autofocus: 'true',\r\n        }\r\n      },\r\n    })\r\n  }\r\n\r\n  get content () {\r\n    const content = defaultMarkdownSerializer.serialize(this.view.state.doc)\r\n    console.log('content', content)\r\n    return content\r\n  }\r\n\r\n  focus () {\r\n    this.view.focus()\r\n  }\r\n\r\n  destroy () {\r\n    this.view.destroy()\r\n  }\r\n}\r\n"],"names":["ProseMirrorView","target","content","console","schema","value","mark","_defaultMarkdownParser_parse","fullMenu","buildMenuItems","item","EditorView","EditorState","undefined","exampleSetup","state","focus","destroy","defaultMarkdownSerializer"],"mappings":"+SAOaA,EAAN,W,SAAMA,gBAGEC,CAAM,CAAEC,CAAO,E,aAHjBF,iBAITG,QAAQ,GAAG,CAAC,eAAgBC,EAAAA,EAAAA,CAAAA,KAAY,EAExCA,EAAAA,EAAAA,CAAAA,KAAAA,CAAAA,SAAsB,CAAG,CACvB,KAAM,CACJ,MAAO,CAAE,MAAO,CAAC,CAAE,EACnB,OAAQ,GACR,SAAU,CACR,CACE,MAAO,QACP,SAAUC,SAAAA,CAAK,E,MAAK,CAAE,MAAOA,CAAM,C,CACrC,EACD,CACD,MAAOC,SAAAA,CAAI,E,MAAI,CAAC,OAAQ,CAAE,MAAQ,UAA0B,OAAjBA,EAAK,KAAK,CAAC,KAAK,CAAG,EAAG,EAAE,A,CACrE,CACF,EAEA,IAmBSC,EAnBHC,EAAWC,AAAAA,GAAAA,EAAAA,EAAAA,AAAAA,EAAeL,EAAAA,EAAMA,EAAE,QAAQ,AAChDI,CAAAA,CAAQ,CAAC,EAAE,CAAGA,CAAQ,CAAC,EAAE,CAAC,MAAM,CAACE,SAAAA,CAAI,E,MAAIA,AAAoB,uBAApBA,EAAK,IAAI,CAAC,KAAK,EAA6BA,AAAoB,qBAApBA,EAAK,IAAI,CAAC,KAAK,A,GACpGF,EAAS,MAAM,CAAC,EAAG,GAClBA,CAAQ,CAAC,EAAE,CAAC,EAAE,CAAS,OAAO,CAAC,KAAK,CAAG,QAYxCA,CAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,EAAG,GACtBL,QAAQ,GAAG,CAAC,WAAYK,GACxB,IAAI,CAAC,IAAI,CAAG,IAAIG,EAAAA,EAAUA,CAACV,EAAQ,CACjC,MAAOW,EAAAA,EAAAA,CAAAA,MAAkB,CAAC,CACxB,IAAKL,MAAAA,CAAAA,EAAAA,EAAAA,EAAAA,CAAAA,KAA2B,CAACL,EAAO,EAAnCK,EAAwCM,KAAAA,EAC7C,QAASC,AAAAA,GAAAA,EAAAA,EAAAA,AAAAA,EAAa,CACpBV,OAAAA,EAAAA,EAAMA,CACN,YAAaI,CACf,EACF,GACA,oBAAYO,CAAK,EACf,MAAO,CACL,YAAa,MACb,eAAgB,MAChB,WAAY,QACZ,UAAW,MACb,CACF,CACF,E,OArDSf,gBAAAA,SAAAA,C,OA8DXgB,EAAAA,KAEC,CAFDA,WACE,IAAI,CAAC,IAAI,CAAC,KAAK,EACjB,EAEAC,EAAAA,OAEC,CAFDA,WACE,IAAI,CAAC,IAAI,CAAC,OAAO,EACnB,E,QApEWjB,gBAAAA,C,CAwDP,c,IAAJ,WACE,IAAME,EAAUgB,EAAAA,EAAAA,CAAAA,SAAmC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,EAEvE,OADAf,QAAQ,GAAG,CAAC,UAAWD,GAChBA,CACT,C,IA5DWF,e"}